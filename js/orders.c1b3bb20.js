(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["orders"],{"159d":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"products"}},[r("b-container",[r("b-row",[r("b-col",{attrs:{cols:"12"}},[r("h1",{staticClass:"text-center"},[e._v("訂單處理")]),r("b-table",{attrs:{striped:"",hover:"",items:e.orders,fields:e.ordersFields},scopedSlots:e._u([{key:"cell(cargoState)",fn:function(t){return[e._v(" "+e._s(t.item.cargoState)+" "),r("b-button",{attrs:{variant:"danger"},on:{click:function(r){e.ordChange(t),e.$bvModal.show("modal-scoped1")}}},[e._v(" 訂單修改 ")])]}},{key:"cell(productsDetail)",fn:function(t){return[r("b-button",{attrs:{variant:"danger"},on:{click:function(r){e.proD(t),e.$bvModal.show("modal-scoped2")}}},[e._v(" 商品詳情 ")])]}},{key:"cell(action)",fn:function(t){return[r("b-button",{attrs:{variant:"danger"},on:{click:function(r){return e.delOrder(t)}}},[r("font-awesome-icon",{attrs:{icon:["fas","trash"]}},[e._v("刪除")])],1)]}}])})],1),r("b-modal",{attrs:{id:"modal-scoped1"},scopedSlots:e._u([{key:"default",fn:function(){return[r("b-form-group",{attrs:{label:"修改訂單"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ariaDescribedby;return[r("b-form-radio",{attrs:{"aria-describedby":a,name:"some-radios",value:"訂單已送出"},model:{value:e.orderStateSelected,callback:function(t){e.orderStateSelected=t},expression:"orderStateSelected"}},[e._v("訂單已送出")]),r("b-form-radio",{attrs:{"aria-describedby":a,name:"some-radios",value:"訂單處理中"},model:{value:e.orderStateSelected,callback:function(t){e.orderStateSelected=t},expression:"orderStateSelected"}},[e._v("訂單處理中")]),r("b-form-radio",{attrs:{"aria-describedby":a,name:"some-radios",value:"訂單已完成"},model:{value:e.orderStateSelected,callback:function(t){e.orderStateSelected=t},expression:"orderStateSelected"}},[e._v("訂單已完成")])]}}])}),r("div",{staticClass:"mt-3"},[e._v("訂單狀態: "),r("strong",[e._v(e._s(e.orderStateSelected))])])]},proxy:!0},{key:"modal-footer",fn:function(t){var a=t.ok;return[r("b-button",{attrs:{size:"sm",variant:"success"},on:{click:function(t){a(),e.changeState()}}},[e._v(" 確認修改 ")])]}}])}),r("b-modal",{attrs:{id:"modal-scoped2"},scopedSlots:e._u([{key:"default",fn:function(){return[r("b-table",{attrs:{striped:"",hover:"",items:e.orders[e.whichOrder].productsDetail,fields:e.cartFields},scopedSlots:e._u([{key:"cell(file)",fn:function(e){return[r("img",{staticStyle:{width:"50px"},attrs:{src:e.item.file}})]}},{key:"cell(allprice)",fn:function(t){return[r("p",[e._v(e._s(t.item.price*t.item.count))])]}}])})]},proxy:!0},{key:"modal-footer",fn:function(t){var a=t.ok;return[r("p",[e._v("總價格："+e._s(e.orders[e.whichOrder].allProductsPrice))]),r("b-button",{attrs:{size:"sm",variant:"success"},on:{click:function(e){return a()}}},[e._v(" OK ")])]}}])})],1)],1)],1)},o=[],n=(r("a434"),r("b0c0"),{name:"orders",data:function(){return{ordersFields:[{key:"user",label:"帳號"},{key:"name",label:"姓名"},{key:"paymentMethod",label:"付款方式"},{key:"deliveryMethod",label:"運送方式"},{key:"phone",label:"電話"},{key:"address",label:"地址"},{key:"date",label:"訂購日期"},{key:"allProductsAmount",label:"總數量"},{key:"allProductsPrice",label:"總價格"},{key:"cargoState",label:"訂單狀態"},{key:"productsDetail",label:"商品詳情"},{key:"action",label:"刪除"}],cartFields:[{key:"file",label:"圖片"},{key:"name",label:"品名"},{key:"price",label:"價格"},{key:"count",label:"數量"},{key:"allprice",label:"合計"}],orders:[],whichOrder:null,whichOrder1:null,orderStateSelected:""}},methods:{ordChange:function(e,t){this.whichOrder1=e.index,this.orderStateSelected=this.orders[this.whichOrder1].cargoState},proD:function(e){this.whichOrder=e.index},delOrder:function(e){var t=this;this.axios.delete("https://coffeec8763.herokuapp.com/orders/admindel/"+e.item._id).then((function(r){r.data.success?t.orders.splice(e.index,1):t.$swal({icon:"error",title:"錯誤",text:r.data.message})})).catch((function(e){t.$swal({icon:"error",title:"錯誤",text:e.response.data.message})}))},changeState:function(e,t){var r=this;t=this.orderStateSelected,e=this.whichOrder1,console.log(this.orders[e]._id),this.axios.patch("https://coffeec8763.herokuapp.com/orders/adminedit/"+this.orders[e]._id,{cargoState:t}).then((function(a){a.data.success?r.orders[e].cargoState=t:r.$swal({icon:"error",title:"錯誤",text:a.data.message})})).catch((function(e){r.$swal({icon:"error",title:"錯誤",text:e.response.data.message})}))}},mounted:function(){var e=this;this.axios.get("https://coffeec8763.herokuapp.com/orders/adminpresent").then((function(t){if(t.data.success){if(0===t.data.result.length)e.orderState=!0;else if(0!==t.data.result.length){e.orderState=!1;for(var r=0;r<t.data.result.length;r++)e.orders.push({_id:t.data.result[r]._id,user:t.data.result[r].user,name:t.data.result[r].name,paymentMethod:t.data.result[r].paymentMethod,deliveryMethod:t.data.result[r].deliveryMethod,phone:t.data.result[r].phone,address:t.data.result[r].address,date:t.data.result[r].date,allProductsAmount:t.data.result[r].allProductsAmount,allProductsPrice:t.data.result[r].allProductsPrice,productsDetail:t.data.result[r].productsDetail,cargoState:t.data.result[r].cargoState})}}else e.$swal({icon:"error",title:"錯誤",text:t.data.message})})).catch((function(t){e.$swal({icon:"error",title:"錯誤",text:t.response.data.message})}))}}),s=n,c=r("2877"),l=Object(c["a"])(s,a,o,!1,null,null,null);t["default"]=l.exports},"1dde":function(e,t,r){var a=r("d039"),o=r("b622"),n=r("2d00"),s=o("species");e.exports=function(e){return n>=51||!a((function(){var t=[],r=t.constructor={};return r[s]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},"65f0":function(e,t,r){var a=r("861d"),o=r("e8b5"),n=r("b622"),s=n("species");e.exports=function(e,t){var r;return o(e)&&(r=e.constructor,"function"!=typeof r||r!==Array&&!o(r.prototype)?a(r)&&(r=r[s],null===r&&(r=void 0)):r=void 0),new(void 0===r?Array:r)(0===t?0:t)}},8418:function(e,t,r){"use strict";var a=r("c04e"),o=r("9bf2"),n=r("5c6c");e.exports=function(e,t,r){var s=a(t);s in e?o.f(e,s,n(0,r)):e[s]=r}},a434:function(e,t,r){"use strict";var a=r("23e7"),o=r("23cb"),n=r("a691"),s=r("50c4"),c=r("7b0b"),l=r("65f0"),d=r("8418"),i=r("1dde"),u=r("ae40"),f=i("splice"),h=u("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,b=Math.min,m=9007199254740991,v="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!f||!h},{splice:function(e,t){var r,a,i,u,f,h,S=c(this),y=s(S.length),k=o(e,y),g=arguments.length;if(0===g?r=a=0:1===g?(r=0,a=y-k):(r=g-2,a=b(p(n(t),0),y-k)),y+r-a>m)throw TypeError(v);for(i=l(S,a),u=0;u<a;u++)f=k+u,f in S&&d(i,u,S[f]);if(i.length=a,r<a){for(u=k;u<y-a;u++)f=u+a,h=u+r,f in S?S[h]=S[f]:delete S[h];for(u=y;u>y-a+r;u--)delete S[u-1]}else if(r>a)for(u=y-a;u>k;u--)f=u+a-1,h=u+r-1,f in S?S[h]=S[f]:delete S[h];for(u=0;u<r;u++)S[u+k]=arguments[u+2];return S.length=y-a+r,i}})},ae40:function(e,t,r){var a=r("83ab"),o=r("d039"),n=r("5135"),s=Object.defineProperty,c={},l=function(e){throw e};e.exports=function(e,t){if(n(c,e))return c[e];t||(t={});var r=[][e],d=!!n(t,"ACCESSORS")&&t.ACCESSORS,i=n(t,0)?t[0]:l,u=n(t,1)?t[1]:void 0;return c[e]=!!r&&!o((function(){if(d&&!a)return!0;var e={length:-1};d?s(e,1,{enumerable:!0,get:l}):e[1]=1,r.call(e,i,u)}))}},e8b5:function(e,t,r){var a=r("c6b6");e.exports=Array.isArray||function(e){return"Array"==a(e)}}}]);
//# sourceMappingURL=orders.c1b3bb20.js.map